<!DOCTYPE html>

<html>

<title>
  This is a title.
</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script>


var HttpClient = function() {
  this.get = function(aUrl,aCallback){
    var anHttpRequest = new XMLHttpRequest();
    anHttpRequest.onreadystatechange = function() {
      if (anHttpRequest.readyState == 4 && anHttpRequest.status == 200)
          aCallback(anHttpRequest.responseText);
    }

    anHttpRequest.open( "GET",aUrl, true );
    anHttpRequest.send( null )
  }
}


var tempJson = '{"1000": "100","500": "50"}';


var client = new HttpClient();
// client.get("http://localhost:8000", function(response) {
//   console.log();
// });

var populateData = function(addr,data){
  client.get(addr, function(response){
    // response is the json object, it has to be parsed
    fixedResponse = customParse(response);
    //console.log(JSON.parse(fixedResponse));
    jsonResponse = JSON.parse(fixedResponse);
    console.log(jsonResponse);
    return(jsonResponse);
  });
  //return(data);
};

var customParse = function (mystring){
  var newString = "";
  for (var i = 0; i < mystring.length; i++) {
    //console.log(mystring[i]=="'");
    if (mystring[i]=="'") {
      newString = newString.concat("\"");
    } else {
      newString = newString.concat(mystring[i]);
    }
  }
  return(newString);
}

var dataPoints = [];

window.setInterval(function(){
  var temp = populateData("http://localhost:8000",dataPoints);
  console.log(JSON.stringify(temp));
},2000);



var newPoint = function(x,y){
  console.log("Mouse X: ",x,"\tMouse Y: ",y);
  if (dataPoints.length == 5) {
    // find closest point based on X
    console.log("dataPoints are full");
  } else {
    console.log("Adding dataPoints");
    dataPoints.push(Object.freeze({x: x, y: y}));
  };
  for (var i = 0; i < dataPoints.length; i++) {
    console.log("Data point",i,"has x: ",dataPoints[i].x,"\ty: ",dataPoints[i].y);
  }
};

$(document).ready(function(){
  $(".graph").click(function(){
    var x = event.clientX;
    var y = event.clientY;
    newPoint(x,y);
  });
});

</script>

<style>

.graph {
  background-color: Tomato;
  color: Blue;
  height: 200px;
  width: 300px;
  margin-left: 20px;
  margin-top: 20px;
}

</style>

<head>
</head>

<body>
  <div class="graph">

  </div>


</body>

</html>
